<h2>Nueva Orden</h2>

<!-- Selecci贸n de Persona -->
<mat-form-field appearance="fill" class="full-width">
  <mat-label>Persona</mat-label>
  <mat-select [(ngModel)]="selectedPerson">
    <mat-option *ngFor="let p of persons" [value]="p.id">{{ p.name }}</mat-option>
  </mat-select>
</mat-form-field>

<!-- Selecci贸n de Item -->
<mat-form-field appearance="fill" class="full-width">
  <mat-label>Item</mat-label>
  <mat-select [(ngModel)]="selectedItem">
    <mat-option *ngFor="let i of items" [value]="i.id">{{ i.name }} - Q{{ i.price }}</mat-option>
  </mat-select>
</mat-form-field>

<!-- Cantidad -->
<mat-form-field appearance="fill" class="small-field">
  <mat-label>Cantidad</mat-label>
  <input matInput type="number" [(ngModel)]="quantity" min="1">
</mat-form-field>

<!-- Bot贸n agregar -->
<button mat-raised-button color="primary" (click)="addItem()">
  Agregar Item
</button>

<!-- Tabla de detalles -->
<h3>Detalles de la orden</h3>
<table mat-table [dataSource]="orderDetails" class="mat-elevation-z8 full-width-table">

  <!-- Columna Item -->
  <ng-container matColumnDef="item">
    <th mat-header-cell *matHeaderCellDef> Item </th>
    <td mat-cell *matCellDef="let d"> {{ getItemName(d.itemId) }} </td>
  </ng-container>

  <!-- Columna Cantidad -->
  <ng-container matColumnDef="cantidad">
    <th mat-header-cell *matHeaderCellDef> Cantidad </th>
    <td mat-cell *matCellDef="let d"> {{ d.quantity }} </td>
  </ng-container>

  <!-- Columna Precio -->
  <ng-container matColumnDef="precio">
    <th mat-header-cell *matHeaderCellDef> Precio </th>
    <td mat-cell *matCellDef="let d"> Q{{ d.price }} </td>
  </ng-container>

  <!-- Columna Total -->
  <ng-container matColumnDef="total">
    <th mat-header-cell *matHeaderCellDef> Total </th>
    <td mat-cell *matCellDef="let d"> Q{{ d.price * d.quantity }} </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="['item','cantidad','precio','total']"></tr>
  <tr mat-row *matRowDef="let row; columns: ['item','cantidad','precio','total'];"></tr>
</table>

<!-- Bot贸n guardar -->
<br>
<button mat-raised-button color="accent" (click)="saveOrder()">
  Guardar Orden
</button>
